<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security5"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <title th:text="${title} ?: 'Products List'">Products List</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

    <!-- products-list.css-->
    <style>
        /* CSS cho hình ảnh trong bảng Admin */
.product-image {
    max-width: 100px;
    max-height: 100px;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

/* CSS cho hình ảnh trong thẻ card của User */
.card-img-top {
    max-height: 200px;
    object-fit: cover;
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
}

/* CSS chung cho hình ảnh trong thẻ card */
.card img {
    width: 100%;
    height: auto;
    border-radius: 4px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

        body {
            margin: 0;
            padding: 0;
            color: #000;
            font-family: 'Arial', sans-serif;
        }
        .home {
            background: url('https://toplist.vn/images/200px/-662146.jpg') no-repeat center center fixed;
            background-size: cover;
            background-position: center;
            min-height: 100vh; /* Đảm bảo phần tử chiếm toàn bộ chiều cao của viewport */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            text-align: center;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
        }
        .container_main {
            text-align: center;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 10px;
        }
        .container_pro {
            text-align: center;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 10px;

        }
        .container_pro h1 {
            font-family: 'Pacifico', cursive;
            color: #ff69b4;
            font-size: 3rem;
            margin-bottom: 20px;
        }
        .home p {
            font-size: 1.3rem;
            line-height: 1.6;
            margin-bottom: 20px;
            color: #333;
            padding: 20px;
            background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
            border-radius: 10px;
            display: inline-block;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-weight: 300;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        .container a.btn-primary {
            font-size: 1.1rem;
            padding: 10px 20px;
            border-radius: 50px;
        }
        .table thead {
            background-color: #ff69b4;
            color: white;
        }
        .table th, .table td {
            text-align: center;
            vertical-align: middle;
        }
        .btn-success, .btn-danger, .btn-warning {
            border-radius: 50px;
        }
        .form-control {
            border-radius: 50px;
        }
        html, body {
            height: 100%;
            margin: 0;
        }
        body {
            display: flex;
            flex-direction: column;
        }
        .content-wrapper {
            flex: 1 0 auto;
        }
        footer {
            flex-shrink: 0;
        }
        @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');

        .container-category-sticky {
            height: 100%;
            padding-left: 0;
        }

        .category-item {
            position: relative;
            padding-left: 20px;
        }
        .category-item__link {
            position: relative;
            text-decoration: none;
            color: var(--text-color);
            font-size: 1.8rem;
            display: block;
            padding: 12px 20px;
        }
        .category-item__link:hover,
        .category-item__list-item-link:hover {
            color: var(--primary-color);
        }
        .category-item__list {
            margin-left: 10px;
        }
        .category-item__list-item {
            position: relative;
        }
        .category-item__list-item-link {
            position: relative;
            text-decoration: none;
            color: var(--text-color);
            font-size: 1.5rem;
            display: block;
            padding: 8px 20px;
        }
    </style>


    <!--****************************************FOOTER.css*******************************************-->
    <style>
        footer {
            background-color: #ff69b4;
            padding: 4px;
            text-align: center;
            color: white;
            width: 100%;
            position: relative;
            margin-top: auto;
            flex-shrink: 0;
        }
        footer a {
            color: white;
            text-decoration: underline;
        }
        footer p {
            margin: 5px 0;
        }

        @import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');
    </style>


    <!--****************************************HEADER/NAVBAR.css*******************************************-->
    <style>
        /* Header and Navbar Styles */
        .top-bar {
            background-color: #ff69b4;
            color: white;
            padding: 3px 0;
            justify-content: center;
        }
        .navbar {
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
            padding: 1px 0; /* Điều chỉnh padding (phần trắng nếu cần */
            font-size: 1.2rem; /* Thay đổi kích thước chữ toàn bộ navbar */
        }
        .navbar-custom {
            position: sticky;
            top: 0;
            z-index: 1030;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .navbar-custom .navbar-nav .nav-link {
            color: black;
            font-weight: 500;
        }
        @media (max-width: 991px) {
          .navbar-nav {
            justify-content: center;
            flex: 1;
          }
          .col-lg-4 {
            margin-bottom: 10px;
          }
        }

        /* Dropdown Menu */
.navbar .dropdown-menu {
    background-color: #ffffff; /* Đổi màu nền thành trắng */
    border: none; /* Remove border */
    border-radius: 4px; /* Rounded corners */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Drop shadow */
}

/* Dropdown Items */
.navbar .dropdown-item {
    color: black; /* Text color */
    font-size: 14px; /* Font size */
    padding: 10px 20px; /* Padding inside dropdown items */
    text-decoration: none; /* No underline */
}

.navbar .dropdown-item:hover {
    background-color: #6c757d; /* Background color on hover */
}

/* Specific Dropdown for ADMIN */
.navbar #adminDropdown .dropdown-menu {
    background-color: #495057; /* Background color of the dropdown menu */
}

.navbar #adminDropdown .dropdown-item {
    color: #fff; /* Text color */
}

/* Specific Dropdown for USER Categories */
.navbar #categoryDropdown .dropdown-menu {
    background-color: #495057; /* Background color of the dropdown menu */
}

.navbar #categoryDropdown .dropdown-item {
    color: #fff; /* Text color */
}


    </style>

    <style>
        /* Category Dropdown */
        .category-dropdown:hover .dropdown-menu {
            display: block;
        }
        .dropdown-menu {
            min-width: 200px;
        }
        .dropdown-item {
            cursor: pointer;
        }

        /* Sort By Styles */
        .sort-by {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;

        }
        .sort-by button {
            margin: 0 5px;
        }
        .product-filter-container {
            background-color: #ff69b4;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>

    <style>
        .category-sidebar {
            background-color: #f8f9fa; /* Màu nền */
            border: 1px solid #dee2e6; /* Đường viền */
            padding-top: 20px; /* Khoảng cách bên trên */
            padding-bottom: 20px; /* Khoảng cách bên dưới */
        }

        .category-title {
            font-size: 18px; /* Cỡ chữ lớn hơn */
            font-weight: bold; /* Đậm */
            color: #333; /* Màu chữ đen */
            margin-bottom: 15px; /* Khoảng cách phía dưới */
            line-height: 1.5; /* Khoảng cách giữa các dòng */
        }

        .category-link {
            font-size: 14px; /* Cỡ chữ nhỏ hơn */
            color: #333; /* Màu chữ đen */
            transition: color 0.3s ease; /* Hiệu ứng chuyển đổi màu */
        }

        .category-link:hover,
        .category-link:focus {
            color: #e83e8c; /* Màu hồng khi di chuột vào hoặc click */
        }
    </style>

</head>

<header>
    <div class="top-bar" style="background-color: #ff69b4;; color: white; padding: 5px 0;">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6">
                    <span class="me-3">HOTLINE: 1900 633 045</span>
                    <span>Contact us :
                        <a href="#" class="me-2 text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="me-2 text-white"><i class="fab fa-instagram"></i></a>
                        <a href="mailto:help@flowers.vn" class="text-white">help@cakes.vn</a>
                    </span>
                </div>
                <div class="col-md-6 text-end">
                    <a href="#" class="me-3 text-white"><i class="far fa-bell"></i> Notify</a>
                    <a href="#" class="me-3 text-white"><i class="far fa-question-circle"></i> Help</a>
                    <span sec:authorize="isAuthenticated()" class="text-white">
                        <i class="far fa-user"></i> <span sec:authentication="name"></span>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-light navbar-custom bg-light fixed-top navbar-custom" style="top: 25px;">
        <div class="container-fluid">
            <a class="navbar-brand" href="/" style="font-family: 'Pacifico', cursive; font-size: 2rem;">Cake Store</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="row w-100 align-items-center">
                    <div class="col-lg-4">
                        <form class="d-flex" action="/search" method="get">
                            <input class="form-control me-2" type="text" name="query" placeholder="Type to search..." aria-label="Search">
                            <button class="btn btn-outline-success" type="submit"><i class="fas fa-search"></i></button>
                        </form>
                    </div>
                    <div class="col-lg-4">
                        <ul class="navbar-nav justify-content-center">
                            <li class="nav-item">
                                <a class="nav-link" href="/">HOME</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/products">PRODUCTS</a>
                            </li>


                            <!---------------------------------- ADMIN ----------------------------------------->
                            <li class="nav-item dropdown" sec:authorize="hasAnyAuthority('ADMIN')">
                                <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    MANAGE
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="adminDropdown">
                                    <li><a class="dropdown-item" th:href="@{/products/add}">Product</a></li>
                                    <li><a class="dropdown-item" th:href="@{/categories/add}">Category</a></li>
                                </ul>
                            </li>

                            <!---------------------------------- USER ----------------------------------------->

                            <li class="nav-item" sec:authorize="hasAnyAuthority('USER')">
                                <a class="nav-link" href="/cart">
                                    <i class="fas fa-shopping-cart"></i> Cart
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-4 text-end">
                        <form th:action="@{/logout}" method="post" style="display: inline;" sec:authorize="isAuthenticated()">
                            <button class="btn btn-outline-danger" type="submit">Logout</button>
                        </form>
                        <a class="btn btn-outline-primary ms-2" href="/login" sec:authorize="!isAuthenticated()">Login</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>


<body>
<!----------------------------------------------- Nội dung chính ----------------------------------------------------------------->
<section class="container_pro" style="background-color: rgb(255, 227, 225); border-radius: 3px;">
    <h1 class="products-title">PRODUCTS LIST</h1>
    <p class="products-description">Discover our delicious cakes, freshly made with the finest ingredients. Perfect for every occasion, from birthdays to weddings, and more! Explore our exquisite range of delicious cakes, crafted using only the finest ingredients. Whether celebrating birthdays, weddings, or any special occasion, our cakes are tailored to perfection, ensuring unforgettable moments with every slice.</p>
</section>

<div class="container_main">
    <div class="row">
        <!-- Cột bên trái (sidebar) -->
        <aside class="col-lg-3" style="border-radius: 3px; border-top: 1px solid #e1e1e1;">
            <div class="category-sidebar">
                <div class="category-title">Categories</div>
                <div class="list-group">
                    <li class="category-item category-item--active">
                        <a href="/products" class="category-item__link">Cakes</a>
                        <ul class="category-item__list">
                            <li class="category-item__list-item category-item--active">
                                <a href="/products" class="category-item__list-item-link">Bánh Kem</a>
                            </li>
                            <li class="category-item__list-item">
                                <a href="/products" class="category-item__list-item-link">Bánh Ngọt</a>
                            </li>
                            <li class="category-item__list-item">
                                <a href="/products" class="category-item__list-item-link">Tráng miệng</a>
                            </li>
                            <li class="category-item__list-item">
                                <a href="/products" class="category-item__list-item-link">Bánh mì</a>
                            </li>
                        </ul>
                    </li>
                    <a th:each="category : ${categories}" th:href="@{/products/category/{id}(id=${category.id})}"
                       th:text="${category.name}" class="list-group-item list-group-item-action category-link"></a>
                </div>
                <div class="category-title mt-4">Filter by Category Name</div>
                <div class="list-group">
                    <a th:each="filter : ${filters}" th:href="@{/products/filter/{id}(id=${filter.id})}"
                       th:text="${filter.name}" class="list-group-item list-group-item-action category-link"></a>
                </div>
            </div>
        </aside>

        <!-- Cột bên phải (content) -->
        <section class="col-lg-9">
            <div layout:fragment="content">
                <!-- Chức năng lọc sản phẩm -->
                <section class="sort-by">
                    <div class="btn-group" role="group" aria-label="Sort By">
                        <button type="button" class="btn btn-secondary">Most Favourite</button>
                        <button type="button" class="btn btn-secondary">Newest</button>
                        <button type="button" class="btn btn-secondary">Best Seller</button>
                    </div>
                </section>

                <!-- Danh sách sản phẩm cho ADMIN -->
                <div th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                    <table class="table table-bordered table-hover">
                        <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Image</th> <!-- Cột hình ảnh -->
                            <th>Name</th>
                            <th>Price</th>
                            <th>Description</th>
                            <th>Category Name</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="product : ${products}">
                            <td th:text="${product.id}"></td>
                            <td>
                                <img th:src="@{${product.imagePath}}" alt="Product Image" class="img-thumbnail" style="width: 100px; height: 100px;">
                            </td>
                            <td th:text="${product.name}"></td>
                            <td th:text="${product.price}"></td>
                            <td th:text="${product.description}"></td>
                            <td th:text="${product.category.name}"></td>
                            <td>
                                <div sec:authorize="hasAuthority('ADMIN')">
                                    <a th:href="@{/products/edit/{id}(id=${product.id})}" class="btn btn-success btn-sm">Sửa</a>
                                    <a th:href="@{/products/delete/{id}(id=${product.id})}" class="btn btn-danger btn-sm" onclick="return confirm('Bạn có chắc không?')">Xóa</a>
                                </div>
                            </td>
                        </tr>
                        </tbody>

                    </table>
                </div>

                <!-- Danh sách sản phẩm cho USER -->
                <div th:unless="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                    <div class="container">
                        <div class="row row-cols-1 row-cols-md-3 g-4">
                            <div class="col mb-4" th:if="${products.isEmpty()}">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title">Không có sản phẩm nào được tìm thấy.</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col mb-4" th:each="product : ${products}">
                                <div class="card h-100">
                                    <img th:src="@{${product.imagePath}}" alt="Product Image" class="card-img-top" style="height: 200px; object-fit: cover;">
                                    <div class="card-body">
                                        <h5 class="card-title" th:text="${product.name}"></h5>
                                        <p class="card-text" th:text="${product.price}"></p>
                                        <p class="card-text" th:text="${product.description}"></p>
                                        <p class="card-text" th:text="${product.category.name}"></p>
                                    </div>
                                    <div class="card-footer">
                                        <form th:action="@{/cart/add}" method="post" sec:authorize="isAuthenticated()">
                                            <input type="number" name="quantity" min="1" value="1" class="form-control d-inline-block" style="width: 70px;">
                                            <input type="hidden" th:value="${product.id}" name="productId"/>
                                            <button type="submit" class="btn btn-warning btn-sm">Thêm Vào Giỏ</button>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <!-- Nút xem thêm -->
                        <div class="text-center">
                            <a href="#" class="btn btn-primary mt-4">Xem thêm</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>




<!---------------------------------------------------- FOOTER ------------------------------------------------------------------>
<footer>
    <p>&copy; 2024 Cake Store. All rights reserved.</p>
    <p>123 Cake Street, Baker's Town, CA 12345</p>
    <p><a href="mailto:info@cakestore.com">info@cakestore.com</a></p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-----------------------------------------NAV_BAR------------------------------------------>
<script>
    // Ensure Bootstrap's JavaScript is included for dropdown functionality
    document.addEventListener('DOMContentLoaded', function() {
      var dropdownElementList = [].slice.call(document.querySelectorAll('.dropdown-toggle'))
      var dropdownList = dropdownElementList.map(function (dropdownToggleEl) {
        return new bootstrap.Dropdown(dropdownToggleEl)
      })
    });
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</body>
</html>
